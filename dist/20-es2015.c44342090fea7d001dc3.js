(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{YxSo:function(e,t,o){"use strict";o.r(t),o.d(t,"CreateGroupModule",(function(){return D}));var n=o("sYmb"),r=o("TEn/"),i=o("tyNb"),s=o("ofXK"),a=o("3Pt+"),c=o("mrSG"),u=o("ec16"),l=o("kt0X");const p=[{name:"groupName"},{name:"owner"},{name:"repondents"},{name:"searchText"}];var b=o("NQLq"),d=o("fkgO");const h=Object(l.o)(e=>e.usersStore,e=>e);var m=o("x6UE"),g=o("fXoL"),f=o("iHIt");function O(e,t){if(1&e){const e=g.Pb();g.Ob(0,"ion-item",15),g.Wb("click",(function(){g.ic(e);const o=t.$implicit;return g.Yb(2).addRepondent(o)})),g.mc(1),g.Nb()}if(2&e){const e=t.$implicit;g.zb(1),g.oc(" ",e.email," ")}}function N(e,t){if(1&e&&(g.Ob(0,"ion-list"),g.lc(1,O,2,1,"ion-item",14),g.Nb()),2&e){const e=g.Yb();g.zb(1),g.dc("ngForOf",e.searchData)}}function w(e,t){if(1&e){const e=g.Pb();g.Mb(0),g.Ob(1,"ion-chip",17),g.Ob(2,"ion-label"),g.mc(3),g.Nb(),g.Ob(4,"ion-icon",18),g.Wb("click",(function(){g.ic(e);const o=t.index;return g.Yb(2).deleteRepondent(o)})),g.Nb(),g.Nb(),g.Lb()}if(2&e){const e=t.$implicit;g.zb(3),g.nc(e)}}function C(e,t){if(1&e&&(g.Ob(0,"ion-card"),g.lc(1,w,5,1,"ng-container",16),g.Nb()),2&e){const e=g.Yb();g.zb(1),g.dc("ngForOf",e.repondentsData)}}let G=(()=>{class e extends u.a{constructor(e,t,o,n,r,i,s){super(n,r,i),this.formBuilder=e,this.router=t,this.toastController=o,this.store=n,this.utils=r,this.translateService=i,this.activatedRoute=s,this.isUpdate=!1,this.repondentsData=[],this.searchText="",this.searchData=[],this.isFocused=!1,this.formGroup=this.utils.buildForm(p),this.utils.resetForm(this.formGroup)}createGroup(){const e={_id:this.groupId,groupName:this.formGroup.get("groupName").value?this.formGroup.get("groupName").value:null,owner:this.formGroup.get("owner").value?this.formGroup.get("owner").value:null,repondents:this.repondentsData||null};this.isUpdate?this.store.dispatch(new b.g(e)):(delete e._id,e.repondents.push(JSON.parse(sessionStorage.user).email),this.store.dispatch(new b.a(e))),this.repondentsData=[]}deleteGroup(){this.store.dispatch(new b.b({_id:this.groupId}))}getDisableDelete(){return JSON.parse(sessionStorage.user).email!==this.formGroup.get("owner").value}updateForm(e){this.formGroup.get("groupName").setValue(e.groupName),this.formGroup.get("owner").setValue(e.owner),this.repondentsData=e.repondents}selectBackUrl(){return this.isUpdate?"tabs/view-groups":"tabs/principal-menu"}addRepondent(e){e&&this.repondentsData.push(e.email)}setFocus(){setTimeout(()=>{this.isFocused=!1},100)}deleteRepondent(e){this.repondentsData.splice(e,1)}search(){this.formGroup.get("searchText").value?this.store.dispatch(new m.c({search:this.formGroup.get("searchText").value})):this.searchData=[]}declareObservables(){this.store.pipe(Object(l.p)(d.a)).subscribe(e=>{e.length>0&&e[0].owner&&this.isUpdate&&this.updateForm(e[0]),e[0]&&e[0].owner!==JSON.parse(sessionStorage.user).email&&this.isUpdate&&(this.formGroup.get("groupName").disable(),this.formGroup.get("repondents").disable())}),this.store.pipe(Object(l.p)(h)).subscribe(e=>{Array.isArray(e)&&(this.searchData=e)}),this.activatedRoute.url.subscribe(e=>{const t=this.router.getCurrentNavigation().extras.state;this.isUpdate=!(!t||!t.data),this.isUpdate?(this.groupId=t.data._id,this.store.dispatch(new b.d({_id:t.data._id}))):(this.utils.resetForm(this.formGroup),this.formGroup.get("owner").setValue(JSON.parse(sessionStorage.user).email)),this.formGroup.get("owner").disable()})}presentToast(){return Object(c.a)(this,void 0,void 0,(function*(){(yield this.toastController.create({message:this.translateService.instant(this.isUpdate?"groups.groupUpdated":"groups.groupCreated"),duration:2e3})).present()}))}ngOnInit(){this.declareObservables()}}return e.\u0275fac=function(t){return new(t||e)(g.Jb(a.a),g.Jb(i.g),g.Jb(r.I),g.Jb(l.h),g.Jb(f.a),g.Jb(n.d),g.Jb(i.a))},e.\u0275cmp=g.Db({type:e,selectors:[["app-create-group"]],features:[g.wb],decls:32,vars:26,consts:[[3,"translucent"],["slot","start"],[3,"defaultHref"],[3,"fullscreen"],[3,"formGroup"],["lines","full"],["position","floating"],["type","text","required","","formControlName","groupName"],["type","text","required","","formControlName","owner"],[1,"autocomplete"],["formControlName","searchText","debounce","100",3,"placeholder","disabled","ionFocus","ionChange","ionBlur"],[4,"ngIf"],["type","submit","color","danger",3,"click"],["type","submit","color","danger",3,"disabled","click"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[4,"ngFor","ngForOf"],[1,"disabled"],["name","close-circle",3,"click"]],template:function(e,t){1&e&&(g.Ob(0,"ion-header",0),g.Ob(1,"ion-toolbar"),g.Ob(2,"ion-buttons",1),g.Kb(3,"ion-back-button",2),g.Ob(4,"ion-title"),g.mc(5),g.Zb(6,"translate"),g.Nb(),g.Nb(),g.Nb(),g.Nb(),g.Ob(7,"ion-content",3),g.Ob(8,"form",4),g.Ob(9,"ion-item",5),g.Ob(10,"ion-label",6),g.mc(11),g.Zb(12,"translate"),g.Nb(),g.Kb(13,"ion-input",7),g.Nb(),g.Ob(14,"ion-item",5),g.Ob(15,"ion-label",6),g.mc(16),g.Zb(17,"translate"),g.Nb(),g.Kb(18,"ion-input",8),g.Nb(),g.Ob(19,"div",9),g.Ob(20,"ion-searchbar",10),g.Wb("ionFocus",(function(){return t.isFocused=!0}))("ionChange",(function(){return t.search()}))("ionBlur",(function(){return t.setFocus()})),g.Zb(21,"translate"),g.Nb(),g.lc(22,N,2,1,"ion-list",11),g.Nb(),g.lc(23,C,2,1,"ion-card",11),g.Ob(24,"ion-row"),g.Ob(25,"ion-col"),g.Ob(26,"ion-button",12),g.Wb("click",(function(){return t.createGroup()})),g.mc(27),g.Zb(28,"translate"),g.Nb(),g.Ob(29,"ion-button",13),g.Wb("click",(function(){return t.deleteGroup()})),g.mc(30),g.Zb(31,"translate"),g.Nb(),g.Nb(),g.Nb(),g.Nb(),g.Nb()),2&e&&(g.dc("translucent",!0),g.zb(3),g.ec("defaultHref",t.selectBackUrl()),g.zb(2),g.nc(g.ac(6,14,t.isUpdate?"group.titleUpdate":"group.title")),g.zb(2),g.dc("fullscreen",!0),g.zb(1),g.dc("formGroup",t.formGroup),g.zb(3),g.nc(g.ac(12,16,"group.groupName")),g.zb(5),g.nc(g.ac(17,18,"group.owner")),g.zb(4),g.ec("placeholder",g.ac(21,20,"group.repondents")),g.ec("disabled",t.getDisableDelete()),g.zb(2),g.dc("ngIf",t.isFocused),g.zb(1),g.dc("ngIf",t.repondentsData&&t.repondentsData.length>0),g.zb(4),g.oc(" ",g.ac(28,22,t.isUpdate?"commons.update":"commons.create")," "),g.zb(2),g.ec("disabled",t.getDisableDelete()),g.zb(1),g.oc(" ",g.ac(31,24,"commons.delete")," "))},directives:[r.l,r.B,r.f,r.c,r.d,r.A,r.j,a.k,a.h,a.c,r.o,r.p,r.n,r.H,a.j,a.g,a.b,r.t,s.j,r.s,r.i,r.e,r.q,s.i,r.g,r.h,r.m],pipes:[n.c],styles:[".autocomplete[_ngcontent-%COMP%]{width:100%}.autocomplete[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{padding:1px!important}.autocomplete[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{position:absolute;width:inherit;overflow-y:scroll;max-height:150%;z-index:999}.autocomplete[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:2.5rem;width:auto;margin:auto;display:block}.autocomplete[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:hover{cursor:pointer;background:#f1f1f1}.autocomplete[_ngcontent-%COMP%]   ion-chip.disabled[_ngcontent-%COMP%]:hover{cursor:unset;background-color:rgba(12,209,232,.08)}"]}),e})();const v=[{path:"",component:G}];let k=(()=>{class e{}return e.\u0275mod=g.Hb({type:e}),e.\u0275inj=g.Gb({factory:function(t){return new(t||e)},imports:[[i.k.forChild(v)],i.k]}),e})(),D=(()=>{class e{}return e.\u0275mod=g.Hb({type:e}),e.\u0275inj=g.Gb({factory:function(t){return new(t||e)},imports:[[r.C,s.b,a.d,a.i,i.k.forChild([{path:"",component:G}]),k,n.b]]}),e})()}}]);