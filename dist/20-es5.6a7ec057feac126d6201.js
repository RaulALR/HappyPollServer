function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,o=_getPrototypeOf(e);if(t){var r=_getPrototypeOf(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{YxSo:function(e,t,n){"use strict";n.r(t),n.d(t,"CreateGroupModule",(function(){return D}));var o=n("sYmb"),r=n("TEn/"),i=n("tyNb"),a=n("ofXK"),s=n("3Pt+"),c=n("mrSG"),u=n("ec16"),l=n("kt0X"),p=[{name:"groupName"},{name:"owner"},{name:"repondents"},{name:"searchText"}],b=n("NQLq"),f=n("fkgO"),d=Object(l.o)((function(e){return e.usersStore}),(function(e){return e})),m=n("x6UE"),h=n("fXoL"),g=n("iHIt");function O(e,t){if(1&e){var n=h.Pb();h.Ob(0,"ion-item",15),h.Wb("click",(function(){h.ic(n);var e=t.$implicit;return h.Yb(2).addRepondent(e)})),h.mc(1),h.Nb()}if(2&e){var o=t.$implicit;h.zb(1),h.oc(" ",o.email," ")}}function v(e,t){if(1&e&&(h.Ob(0,"ion-list"),h.lc(1,O,2,1,"ion-item",14),h.Nb()),2&e){var n=h.Yb();h.zb(1),h.dc("ngForOf",n.searchData)}}function y(e,t){if(1&e){var n=h.Pb();h.Mb(0),h.Ob(1,"ion-chip",17),h.Ob(2,"ion-label"),h.mc(3),h.Nb(),h.Ob(4,"ion-icon",18),h.Wb("click",(function(){h.ic(n);var e=t.index;return h.Yb(2).deleteRepondent(e)})),h.Nb(),h.Nb(),h.Lb()}if(2&e){var o=t.$implicit;h.zb(3),h.nc(o)}}function _(e,t){if(1&e&&(h.Ob(0,"ion-card"),h.lc(1,y,5,1,"ng-container",16),h.Nb()),2&e){var n=h.Yb();h.zb(1),h.dc("ngForOf",n.repondentsData)}}var w,N,C,k=((w=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,o,r,i,a,s,c){var u;return _classCallCheck(this,n),(u=t.call(this,i,a,s)).formBuilder=e,u.router=o,u.toastController=r,u.store=i,u.utils=a,u.translateService=s,u.activatedRoute=c,u.isUpdate=!1,u.searchText="",u.searchData=[],u.isFocused=!1,u.formGroup=u.utils.buildForm(p),u.utils.resetForm(u.formGroup),u}return _createClass(n,[{key:"createGroup",value:function(){var e={_id:this.groupId,groupName:this.formGroup.get("groupName").value?this.formGroup.get("groupName").value:null,owner:this.formGroup.get("owner").value?this.formGroup.get("owner").value:null,repondents:this.repondentsData||null};this.isUpdate?this.store.dispatch(new b.g(e)):(delete e._id,e.repondents.push(JSON.parse(sessionStorage.user).email),this.store.dispatch(new b.a(e))),this.repondentsData=[]}},{key:"deleteGroup",value:function(){this.store.dispatch(new b.b({_id:this.groupId}))}},{key:"getDisableDelete",value:function(){return JSON.parse(sessionStorage.user).email!==this.formGroup.get("owner").value}},{key:"updateForm",value:function(e){this.formGroup.get("groupName").setValue(e.groupName),this.formGroup.get("owner").setValue(e.owner),this.repondentsData=Object.values(e.repondents)}},{key:"selectBackUrl",value:function(){return this.isUpdate?"tabs/view-groups":"tabs/principal-menu"}},{key:"addRepondent",value:function(e){e&&Array.isArray(this.repondentsData)&&this.repondentsData.push(e.email)}},{key:"setFocus",value:function(){var e=this;setTimeout((function(){e.isFocused=!1}),100)}},{key:"deleteRepondent",value:function(e){this.repondentsData.splice(e,1)}},{key:"search",value:function(){this.formGroup.get("searchText").value?this.store.dispatch(new m.c({search:this.formGroup.get("searchText").value})):this.searchData=[]}},{key:"declareObservables",value:function(){var e=this;this.store.pipe(Object(l.p)(f.a)).subscribe((function(t){t.length>0&&t[0].owner&&e.isUpdate&&e.updateForm(t[0]),t[0]&&t[0].owner!==JSON.parse(sessionStorage.user).email&&e.isUpdate&&(e.formGroup.get("groupName").disable(),e.formGroup.get("repondents").disable())})),this.store.pipe(Object(l.p)(d)).subscribe((function(t){Array.isArray(t)&&(e.searchData=t)})),this.activatedRoute.url.subscribe((function(t){var n=e.router.getCurrentNavigation().extras.state;e.isUpdate=!(!n||!n.data),e.isUpdate?(e.groupId=n.data._id,e.store.dispatch(new b.d({_id:n.data._id}))):(e.utils.resetForm(e.formGroup),e.formGroup.get("owner").setValue(JSON.parse(sessionStorage.user).email)),e.formGroup.get("owner").disable()}))}},{key:"presentToast",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toastController.create({message:this.translateService.instant(this.isUpdate?"groups.groupUpdated":"groups.groupCreated"),duration:2e3});case 2:e.sent.present();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"ngOnInit",value:function(){this.declareObservables()}}]),n}(u.a)).\u0275fac=function(e){return new(e||w)(h.Jb(s.a),h.Jb(i.g),h.Jb(r.I),h.Jb(l.h),h.Jb(g.a),h.Jb(o.d),h.Jb(i.a))},w.\u0275cmp=h.Db({type:w,selectors:[["app-create-group"]],features:[h.wb],decls:32,vars:26,consts:[[3,"translucent"],["slot","start"],[3,"defaultHref"],[3,"fullscreen"],[3,"formGroup"],["lines","full"],["position","floating"],["type","text","required","","formControlName","groupName"],["type","text","required","","formControlName","owner"],[1,"autocomplete"],["formControlName","searchText","debounce","100",3,"placeholder","disabled","ionFocus","ionChange","ionBlur"],[4,"ngIf"],["type","submit","color","danger",3,"click"],["type","submit","color","danger",3,"disabled","click"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[4,"ngFor","ngForOf"],[1,"disabled"],["name","close-circle",3,"click"]],template:function(e,t){1&e&&(h.Ob(0,"ion-header",0),h.Ob(1,"ion-toolbar"),h.Ob(2,"ion-buttons",1),h.Kb(3,"ion-back-button",2),h.Ob(4,"ion-title"),h.mc(5),h.Zb(6,"translate"),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Ob(7,"ion-content",3),h.Ob(8,"form",4),h.Ob(9,"ion-item",5),h.Ob(10,"ion-label",6),h.mc(11),h.Zb(12,"translate"),h.Nb(),h.Kb(13,"ion-input",7),h.Nb(),h.Ob(14,"ion-item",5),h.Ob(15,"ion-label",6),h.mc(16),h.Zb(17,"translate"),h.Nb(),h.Kb(18,"ion-input",8),h.Nb(),h.Ob(19,"div",9),h.Ob(20,"ion-searchbar",10),h.Wb("ionFocus",(function(){return t.isFocused=!0}))("ionChange",(function(){return t.search()}))("ionBlur",(function(){return t.setFocus()})),h.Zb(21,"translate"),h.Nb(),h.lc(22,v,2,1,"ion-list",11),h.Nb(),h.lc(23,_,2,1,"ion-card",11),h.Ob(24,"ion-row"),h.Ob(25,"ion-col"),h.Ob(26,"ion-button",12),h.Wb("click",(function(){return t.createGroup()})),h.mc(27),h.Zb(28,"translate"),h.Nb(),h.Ob(29,"ion-button",13),h.Wb("click",(function(){return t.deleteGroup()})),h.mc(30),h.Zb(31,"translate"),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb()),2&e&&(h.dc("translucent",!0),h.zb(3),h.ec("defaultHref",t.selectBackUrl()),h.zb(2),h.nc(h.ac(6,14,t.isUpdate?"group.titleUpdate":"group.title")),h.zb(2),h.dc("fullscreen",!0),h.zb(1),h.dc("formGroup",t.formGroup),h.zb(3),h.nc(h.ac(12,16,"group.groupName")),h.zb(5),h.nc(h.ac(17,18,"group.owner")),h.zb(4),h.ec("placeholder",h.ac(21,20,"group.repondents")),h.ec("disabled",t.getDisableDelete()),h.zb(2),h.dc("ngIf",t.isFocused),h.zb(1),h.dc("ngIf",t.repondentsData&&t.repondentsData.length>0),h.zb(4),h.oc(" ",h.ac(28,22,t.isUpdate?"commons.update":"commons.create")," "),h.zb(2),h.ec("disabled",t.getDisableDelete()),h.zb(1),h.oc(" ",h.ac(31,24,"commons.delete")," "))},directives:[r.l,r.B,r.f,r.c,r.d,r.A,r.j,s.k,s.h,s.c,r.o,r.p,r.n,r.H,s.j,s.g,s.b,r.t,a.j,r.s,r.i,r.e,r.q,a.i,r.g,r.h,r.m],pipes:[o.c],styles:[".autocomplete[_ngcontent-%COMP%]{width:100%}.autocomplete[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{padding:1px!important}.autocomplete[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{position:absolute;width:inherit;overflow-y:scroll;max-height:150%;z-index:999}.autocomplete[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:2.5rem;width:auto;margin:auto;display:block}.autocomplete[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:hover{cursor:pointer;background:#f1f1f1}.autocomplete[_ngcontent-%COMP%]   ion-chip.disabled[_ngcontent-%COMP%]:hover{cursor:unset;background-color:rgba(12,209,232,.08)}"]}),w),P=[{path:"",component:k}],G=((C=function e(){_classCallCheck(this,e)}).\u0275mod=h.Hb({type:C}),C.\u0275inj=h.Gb({factory:function(e){return new(e||C)},imports:[[i.k.forChild(P)],i.k]}),C),D=((N=function e(){_classCallCheck(this,e)}).\u0275mod=h.Hb({type:N}),N.\u0275inj=h.Gb({factory:function(e){return new(e||N)},imports:[[r.C,a.b,s.d,s.i,i.k.forChild([{path:"",component:k}]),G,o.b]]}),N)}}]);