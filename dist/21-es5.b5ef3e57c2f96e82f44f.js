function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var o,r=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{xjHI:function(e,t,o){"use strict";o.r(t),o.d(t,"CreatePollModule",(function(){return D}));var r=o("sYmb"),n=o("TEn/"),i=o("tyNb"),a=o("ofXK"),s=o("3Pt+"),l=o("mrSG"),u=o("kt0X"),c=o("NQLq"),p=o("fkgO"),b=o("vifI"),f=o("F8ix"),d=o("ec16"),m=[{name:"pollName"},{name:"groupPoll"},{name:"questions"}],h=o("fXoL"),g=o("iHIt");function v(e,t){if(1&e&&(h.Ob(0,"ion-select-option",15),h.mc(1),h.Nb()),2&e){var o=t.$implicit;h.ec("value",o.groupName),h.zb(1),h.oc("",o.groupName," ")}}function O(e,t){if(1&e){var o=h.Pb();h.Mb(0),h.Ob(1,"ion-item"),h.Ob(2,"ion-label"),h.mc(3),h.Nb(),h.Ob(4,"ion-icon",17),h.Wb("click",(function(){h.ic(o);var e=t.index;return h.Yb(2).deleteQuestion(e)})),h.Nb(),h.Nb(),h.Lb()}if(2&e){var r=t.$implicit;h.zb(3),h.nc(r)}}function y(e,t){if(1&e&&(h.Ob(0,"ion-list"),h.lc(1,O,5,1,"ng-container",16),h.Nb()),2&e){var o=h.Yb();h.zb(1),h.dc("ngForOf",o.questionData)}}function N(e,t){if(1&e){var o=h.Pb();h.Ob(0,"div",18),h.Ob(1,"ion-button",19),h.mc(2),h.Zb(3,"translate"),h.Nb(),h.Ob(4,"ion-button",20),h.Wb("click",(function(){return h.ic(o),h.Yb().deletePoll()})),h.mc(5),h.Zb(6,"translate"),h.Nb(),h.Nb()}if(2&e){var r=h.Yb();h.zb(1),h.dc("disabled",!r.formGroup.valid),h.zb(1),h.oc(" ",h.ac(3,4,r.isUpdate?"commons.update":"commons.create")," "),h.zb(2),h.ec("disabled",r.getDisableDelete()),h.zb(1),h.oc(" ",h.ac(6,6,"commons.delete")," ")}}var P,_,k,w=((P=function(e){_inherits(o,e);var t=_createSuper(o);function o(e,r,n,i,a,s,l){var u;return _classCallCheck(this,o),(u=t.call(this,i,a,s)).formBuilder=e,u.router=r,u.toastController=n,u.store=i,u.utils=a,u.translateService=s,u.activatedRoute=l,u.isUpdate=!1,u.groupData=[],u.questionData=[],u.compareWithGroup=function(e,t){return e===t},u.formGroup=u.utils.buildForm(m),u.utils.resetForm(u.formGroup),u}return _createClass(o,[{key:"saveData",value:function(){var e={_id:this.pollId,pollName:this.formGroup.get("pollName").value?this.formGroup.get("pollName").value:null,groupPoll:this.formGroup.get("groupPoll").value?this.formGroup.get("groupPoll").value:null,questions:this.questionData||null,owner:JSON.parse(sessionStorage.user).email};this.isUpdate?this.store.dispatch(new b.g(e)):(delete e._id,this.store.dispatch(new b.a(e)))}},{key:"pollCreated",value:function(){this.presentToast(),this.router.navigate(["/tabs"])}},{key:"getDisableDelete",value:function(){var e=this,t=!0;return this.groupData&&this.formGroup.get("groupPoll").value&&this.groupData.forEach((function(o){o.groupName===e.formGroup.get("groupPoll").value&&o.owner===JSON.parse(sessionStorage.user).email&&(e.formGroup.get("groupPoll").enable(),t=!1)})),t}},{key:"showButtons",value:function(){return!this.isUpdate||this.groupData&&this.groupData[0]&&this.groupData[0].owner===JSON.parse(sessionStorage.user).email}},{key:"deletePoll",value:function(){this.store.dispatch(new b.b({_id:this.pollId}))}},{key:"addQuestion",value:function(){this.formGroup.get("questions").value&&(this.questionData.push(this.formGroup.get("questions").value),this.formGroup.get("questions").setValue(""))}},{key:"deleteQuestion",value:function(e){this.questionData.splice(e,1)}},{key:"updateForm",value:function(e){this.formGroup.get("pollName").setValue(e.pollName),this.formGroup.get("groupPoll").setValue(e.groupPoll),this.questionData=e.questions}},{key:"presentToast",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toastController.create({message:this.translateService.instant("createPoll.pollCreated"),duration:2e3});case 2:e.sent.present();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"ngOnInit",value:function(){var e=this;this.store.pipe(Object(u.p)(f.a)).subscribe((function(t){t.length>0&&e.isUpdate&&e.updateForm(t[0])})),this.store.pipe(Object(u.p)(p.a)).subscribe((function(t){Array.isArray(t)&&(e.groupData=t)})),this.activatedRoute.url.subscribe((function(t){var o=e.router.getCurrentNavigation().extras.state;e.isUpdate=!(!o||!o.data),e.store.dispatch(new c.f({owner:JSON.parse(sessionStorage.user).email})),e.isUpdate?(e.formGroup.get("groupPoll").disable(),e.pollId=o.data._id,e.store.dispatch(new b.d({_id:o.data._id}))):e.utils.resetForm(e.formGroup)}))}}]),o}(d.a)).\u0275fac=function(e){return new(e||P)(h.Jb(s.a),h.Jb(i.g),h.Jb(n.I),h.Jb(u.h),h.Jb(g.a),h.Jb(r.d),h.Jb(i.a))},P.\u0275cmp=h.Db({type:P,selectors:[["app-create-poll"]],features:[h.wb],decls:31,vars:25,consts:[[3,"translucent"],["slot","start"],["defaultHref","/tabs/principal-menu"],[3,"fullscreen"],[3,"formGroup","ngSubmit"],["lines","full"],["position","floating"],["type","text","required","","formControlName","pollName"],["required","","formControlName","groupPoll",3,"okText","cancelText","compareWith"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","questions"],["name","add-outline","slot","end",3,"click"],[4,"ngIf"],["padding","",4,"ngIf"],[3,"value"],[4,"ngFor","ngForOf"],["name","close-outline","slot","end",3,"click"],["padding",""],["block","","type","submit",3,"disabled"],["type","submit","color","danger",3,"disabled","click"]],template:function(e,t){1&e&&(h.Ob(0,"ion-header",0),h.Ob(1,"ion-toolbar"),h.Ob(2,"ion-buttons",1),h.Kb(3,"ion-back-button",2),h.Ob(4,"ion-title"),h.mc(5),h.Zb(6,"translate"),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Ob(7,"ion-content",3),h.Ob(8,"form",4),h.Wb("ngSubmit",(function(){return t.saveData()})),h.Ob(9,"ion-item",5),h.Ob(10,"ion-label",6),h.mc(11),h.Zb(12,"translate"),h.Nb(),h.Kb(13,"ion-input",7),h.Nb(),h.Ob(14,"ion-item",5),h.Ob(15,"ion-label",6),h.mc(16),h.Zb(17,"translate"),h.Nb(),h.Ob(18,"ion-select",8),h.Zb(19,"translate"),h.Zb(20,"translate"),h.Kb(21,"ion-select-option",9),h.lc(22,v,2,2,"ion-select-option",10),h.Nb(),h.Nb(),h.Ob(23,"ion-item",5),h.Ob(24,"ion-label",6),h.mc(25),h.Zb(26,"translate"),h.Nb(),h.Kb(27,"ion-input",11),h.Ob(28,"ion-icon",12),h.Wb("click",(function(){return t.addQuestion()})),h.Nb(),h.Nb(),h.lc(29,y,2,1,"ion-list",13),h.lc(30,N,7,8,"div",14),h.Nb(),h.Nb()),2&e&&(h.dc("translucent",!0),h.zb(5),h.nc(h.ac(6,13,t.isUpdate?"createPoll.titleUpdate":"createPoll.title")),h.zb(2),h.dc("fullscreen",!0),h.zb(1),h.dc("formGroup",t.formGroup),h.zb(3),h.nc(h.ac(12,15,"createPoll.pollName")),h.zb(5),h.nc(h.ac(17,17,"createPoll.groupPoll")),h.zb(2),h.ec("okText",h.ac(19,19,"commons.select")),h.ec("cancelText",h.ac(20,21,"commons.cancel")),h.dc("compareWith",t.compareWithGroup),h.zb(4),h.dc("ngForOf",t.groupData),h.zb(3),h.nc(h.ac(26,23,"createPoll.questions")),h.zb(4),h.dc("ngIf",t.questionData),h.zb(1),h.dc("ngIf",t.showButtons()))},directives:[n.l,n.B,n.f,n.c,n.d,n.A,n.j,s.k,s.h,s.c,n.o,n.p,n.n,n.H,s.j,s.g,s.b,n.u,n.G,n.v,a.i,n.m,a.j,n.q,n.e],pipes:[r.c],styles:[""]}),P),C=[{path:"",component:w}],G=((k=function e(){_classCallCheck(this,e)}).\u0275mod=h.Hb({type:k}),k.\u0275inj=h.Gb({factory:function(e){return new(e||k)},imports:[[i.k.forChild(C)],i.k]}),k),D=((_=function e(){_classCallCheck(this,e)}).\u0275mod=h.Hb({type:_}),_.\u0275inj=h.Gb({factory:function(e){return new(e||_)},imports:[[n.C,a.b,s.d,s.i,i.k.forChild([{path:"",component:w}]),G,r.b]]}),_)}}]);